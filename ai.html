<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Candy Picking App</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1,user-scalable=no">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900;700;600;500&display=swap" rel="stylesheet">
  <style>
    html,body {
      margin:0; padding:0; width:100vw; height:100vh; overflow:hidden;
      font-family:'Montserrat',Arial,sans-serif;
      background: #181a1a;
      user-select:none; -webkit-user-select:none;
      touch-action:manipulation;
    }
    body {
      background:url('https://i.ibb.co/b5dqkL9N/candy-land-background-ei089uq3wekctn4y.jpg') center/cover no-repeat;
      min-height:100dvh;
    }
    .bg-blur {
      position:fixed; left:0;top:0; width:100vw; height:100vh; z-index:1;
      backdrop-filter: blur(13px) brightness(0.85) contrast(1.08);
      background:rgba(34,42,65,0.24);
      pointer-events:none;
    }
    .app-wrap {
      position:fixed; left:0; top:0; width:100vw; height:100vh;
      display:flex; flex-direction:column; align-items:center; justify-content:center; z-index:3;
      overflow:hidden;
      touch-action:manipulation;
    }
    .robot {
      position:fixed; left:50vw; top:47vh; transform:translate(-50%,-50%);
      width:180px; height:180px; z-index:11;
      display:flex; flex-direction:column; align-items:center; pointer-events:none;
    }
    .robot-img {
      width:180px; height:180px; object-fit:contain; border-radius:50%;
      box-shadow:0 0 64px #41e6f244,0 0 0 13px #c8fff82f;
      background:rgba(255,255,255,0.08);
    }
    .robot-eyes-glow {
      position:absolute; left:50%; top:46.2%; width:57px; height:17px;
      transform:translate(-50%,-50%);
      border-radius:11px; z-index:2; pointer-events:none;
      box-shadow:0 0 23px 9px #21aaff,0 0 15px 5px #21ffc9;
      background:rgba(55,180,255,0.15);
      opacity:0; transition:opacity .36s;
    }
    .robot-eyes-glow.on { opacity:1; animation:eyesGlow 1.4s infinite alternate;}
    @keyframes eyesGlow { 100%{box-shadow:0 0 43px 14px #5ee0ff;} }
    .pick-row {
      position:fixed; width:100vw; left:0; display:flex; flex-direction:column; align-items:center; z-index:9;
      pointer-events:auto; user-select:none;
    }
    .pick-top { top:9dvh; }
    .pick-bot { bottom:13dvh;}
    .pick-card {
  width: 93vw; max-width: 470px;
  height: 34vw; max-height: 190px;
  margin: 0 auto 4vh auto;
  border-radius: 25px;
  border: 4px solid #25cfff;
  background: transparent;
  box-shadow: none;
  display: flex; align-items: center; justify-content: center;
  position: relative;
  overflow: hidden;
}
.pick-card.selected { border:4px solid #1ae7a7; box-shadow:0 0 30px #1ae7d655;}
.pick-img {
  width: 97%; height: 97%;
  object-fit: contain;
  display: block;
  background: none;
  box-shadow: none;
  border-radius: 18px;
  border: none;
  margin: 0 auto;
  pointer-events: none;
}
@media (max-width: 520px) {
  .pick-card {
    width: 97vw; max-width: 99vw;
    height: 29vw; max-height: 110px;
    border-radius: 17px;
    margin-bottom: 2vh;
  }
  .pick-img {
    width: 94vw; height: 27vw; max-height: 100px;
    border-radius: 13px;
  }
}

    /* Final grid */
    .final-grid {
      position:fixed; left:50vw; top:54vh; transform:translate(-50%,-52%);
      display:grid; grid-template-columns:repeat(2,1fr); grid-gap:22px;
      z-index:18; width:92vw; min-width:0; min-height:170px; max-width:400px; opacity:0; transition:opacity .21s;
    }
    .final-grid.show { opacity:1; }
    .final-grid .pick-card {
      opacity:1; pointer-events:none; min-width:0; width:41vw; max-width:170px; height:94px; border-radius:15px;
      transition:opacity .28s, transform .47s cubic-bezier(.71,1.2,.36,1.09);
      margin:0 auto;
    }
    .final-grid .pick-img { width:69px; height:69px;}
    /* Box gif */
    .box-gif-wrap {
      position:fixed; left:0;top:0; width:100vw; height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:center; z-index:19999; background:rgba(0,0,0,0.07); pointer-events:none;
      backdrop-filter: blur(8px);
    }
    .box-gif-wrap .loader { margin-bottom:13px; }
    .box-gif { width:175px; height:auto; margin:0 auto;}
    .done-block {
      position:fixed; left:50vw; top:50vh; transform:translate(-50%,-50%);
      display:flex; flex-direction:column; align-items:center; z-index:30000;
      opacity:0; pointer-events:none; transition:opacity .3s; min-width:180px;
    }
    .done-block.show { opacity:1; pointer-events:all;}
    /* --- Arrow bubble --- */
    .done-bubble {
      background:#fff; border-radius:17px; box-shadow:0 3px 22px #45ffe98b,0 1px 8px #68c6fc10;
      display:flex; flex-direction:column; align-items:center; padding:26px 9vw 23px 9vw;
      margin:0 auto; min-width:130px; max-width:98vw;
    }
    .big-arrow {
      margin-bottom:13px; margin-top:3px;
      display:flex; align-items:center; justify-content:center;
    }
    .success-text { font-size:1.13rem; font-weight:900; margin-top:14px; color:#23a768; text-align:center; letter-spacing:.01em; text-shadow:0 2px 10px #23e58d2c;}
    @keyframes pop { 0%{transform:scale(.85); opacity:.2;} 100%{transform:scale(1);opacity:1;} }
    ::-webkit-scrollbar{display:none;}
    @media (max-width: 520px) {
      .robot, .robot-img { width:120px!important; height:120px!important; }
      .robot-eyes-glow { width:33px!important; height:13px!important; }
      .pick-card, .pick-card.in { width:94vw; max-width:99vw; height:97px; max-height:110px; }
      .pick-img { width:85%; height:85%; }
    }
  </style>
</head>
<body>
<div class="bg-blur"></div>
<div class="app-wrap" id="appWrap">
  <div class="robot" id="robot">
    <img src="https://i.ibb.co/M5NTbkRD/Chat-GPT-Image-16-2025-14-16-44.png" class="robot-img" id="robotImg">
    <div class="robot-eyes-glow" id="robotGlow"></div>
  </div>
  <div class="pick-row pick-top" id="pickTop"></div>
  <div class="pick-row pick-bot" id="pickBot"></div>
  <div class="final-grid" id="finalGrid"></div>
  <div class="box-gif-wrap" id="boxGifWrap" style="display:none;">
    <div class="loader">
      <svg width="66" height="66"><circle cx="33" cy="33" r="28" fill="none" stroke="#fff" stroke-width="7" opacity="0.23"/><circle cx="33" cy="33" r="28" fill="none" stroke="#b788ff" stroke-width="7" stroke-linecap="round" stroke-dasharray="160" stroke-dashoffset="40"><animateTransform attributeName="transform" type="rotate" values="0 33 33;360 33 33" dur="1.1s" repeatCount="indefinite"/></circle></svg>
    </div>
    <div style="font-size:1.19rem;font-weight:900;color:#fff;text-align:center;margin-bottom:18px;text-shadow:0 2px 9px #bdaaff8c;">Packing your products...</div>
    <img src="https://i.ibb.co/zWySdkQ9/original-0729685bddace62296358-unscreen.gif" class="box-gif">
  </div>
  <div class="done-block" id="doneBlock" style="display:none;">
    <div class="done-bubble">
      <div class="big-arrow">
        <svg width="60" height="60" viewBox="0 0 70 70">
          <circle cx="35" cy="35" r="34" fill="#e7fff8" stroke="#2ce3b3" stroke-width="4"/>
          <polyline points="18,36 34,52 52,18" fill="none" stroke="#1ed47d" stroke-width="8" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="success-text">Items are on the way!</div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
<script>
  // --- ВЫБОР ТОВАРОВ ---
  const rounds = [
    [
      {img:'https://i.ibb.co/BFzKcpx/81-XVBOp-Zq1-L-UF350-350-QL80.jpg'},
      {img:'https://i.ibb.co/FkQpzjBd/chupachups.jpg'}
    ],
    [
      {img:'https://i.ibb.co/S7DCspTS/1.png'},
      {img:'https://i.ibb.co/5h9x57qR/2.png'}
    ]
  ];
  const finalItems = [
    {img:'https://i.ibb.co/9mvzD20g/3.png'},
    {img:'https://i.ibb.co/HfKkd3Xy/4.png'},
    {img:'https://i.ibb.co/BFzKcpx/81-XVBOp-Zq1-L-UF350-350-QL80.jpg'},
    {img:'https://i.ibb.co/FkQpzjBd/chupachups.jpg'},
  ];
  let round = 0, chosen = [], canPick = true;
  const pickTop = document.getElementById('pickTop');
  const pickBot = document.getElementById('pickBot');
  const robotGlow = document.getElementById('robotGlow');
  const robot = document.getElementById('robot');
  const boxGifWrap = document.getElementById('boxGifWrap');
  function showPair() {
    pickTop.innerHTML = pickBot.innerHTML = '';
    robotGlow.className = "robot-eyes-glow";
    canPick = true;
    let pair = rounds[round];
    pickTop.innerHTML = `<div class="pick-card top" id="pickCard0"><img src="${pair[0].img}" class="pick-img"></div>`;
    pickBot.innerHTML = `<div class="pick-card bot" id="pickCard1"><img src="${pair[1].img}" class="pick-img"></div>`;
    gsap.set("#pickCard0", {opacity:0, x:window.innerWidth*1.1, pointerEvents:"none"});
    gsap.set("#pickCard1", {opacity:0, x:-window.innerWidth*1.1, pointerEvents:"none"});
    gsap.to("#pickCard0", {
      opacity:1, x:0, duration:.52, ease:"expo.out",
      onComplete:()=>{document.getElementById('pickCard0').style.pointerEvents = "auto";}
    });
    setTimeout(()=>{
      gsap.to("#pickCard1", {
        opacity:1, x:0, duration:.52, ease:"expo.out",
        onComplete:()=>{document.getElementById('pickCard1').style.pointerEvents = "auto";}
      });
    },170);
    setTimeout(()=>{
      document.getElementById('pickCard0').onclick = ()=>pickCard(0);
      document.getElementById('pickCard1').onclick = ()=>pickCard(1);
    },520);
  }
  function pickCard(idx) {
    if(!canPick) return;
    canPick = false;
    robotGlow.className = "robot-eyes-glow on";
    document.getElementById('pickCard'+idx).classList.add('selected');
    chosen.push(rounds[round][idx]);
    gsap.to("#pickCard0", {opacity:0, y:-85, duration:.44, delay:.19, ease:"power1.in"});
    gsap.to("#pickCard1", {opacity:0, y:85, duration:.44, delay:.19, ease:"power1.in"});
    setTimeout(()=>{
      if(round<rounds.length-1){ round++; showPair(); } else { showFinal(); }
    },640);
  }
  function showFinal() {
    pickTop.innerHTML = pickBot.innerHTML = "";
    robot.style.top = "14dvh";
    robotGlow.className = "robot-eyes-glow on";
    const grid = document.getElementById('finalGrid');
    grid.innerHTML = finalItems.map(item => `<div class="pick-card in"><img src="${item.img}" class="pick-img"></div>`).join('');
    grid.classList.add('show');
    setTimeout(()=>{boxGifAnim();},820);
  }
  function boxGifAnim() {
    document.getElementById('finalGrid').classList.remove('show');
    boxGifWrap.style.display = "flex";
    setTimeout(()=>{
      boxGifWrap.style.display = "none";
      showDone();
    }, 3150); // длительность гифки упаковки!
  }
  function showDone() {
    const done = document.getElementById('doneBlock');
    done.style.display='flex'; setTimeout(()=>{ done.classList.add('show'); },14);
    setTimeout(()=>{
      done.classList.remove('show');
      setTimeout(()=>{
        done.style.display='none';
        robot.style.top="47vh"; round=0; chosen=[];
        showPair();
      },400);
    },2450);
  }
  showPair();
</script>
</body>
</html>
